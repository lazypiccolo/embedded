// ST7735 driver
#include<stc12.h>
#include<string.h>
#include "lcd_st7735.h"

// hardware: STC12C5608AD
// crystal frequency: 32MHZ


void show_all_chars(int offset, TextStyle *text_style) {
    uchar left_border = 0;
    uchar top_border = 0;
    for (int i = 0; i < 10; i++) {
        for (int j = 0; j < 14; j++) {
            Lcd_ShowLcd1602Char(left_border + j * 6, top_border + i * 8, (i * 14 + j + offset) % 128, text_style);
        }
    }
}

#define IMAGE_WIDTH 30
#define IMAGE_HEIGHT 30
// mind the image eeprom/ram usage!
// there is a python tool to generate the image data included in this repo.
__code unsigned int screen_shot[IMAGE_HEIGHT][IMAGE_WIDTH] = {
        {0x488f, 0x488f, 0x50b0, 0x58b0, 0x58af, 0x78ee, 0x4179, 0x4138, 0x40f7, 0x38d7, 0x38b6, 0x38b7, 0x3896, 0x3896, 0x3896, 0x3896, 0x3875, 0x3855, 0x3875, 0xdedc, 0x2871, 0x3893, 0xffff, 0xffff, 0x3894, 0x204c, 0x3071, 0x9cb5, 0x3051, 0x3050,},
        {0x488f, 0x488f, 0x508f, 0x508f, 0x58b0, 0x60af, 0x78ee, 0x4157, 0x4117, 0x40f6, 0x38d6, 0x38b6, 0x3896, 0x3875, 0x3896, 0x3875, 0x3875, 0x3875, 0x3875, 0x3875, 0x3873, 0x3893, 0x3894, 0x3893, 0x3873, 0x3872, 0x3871, 0x3871, 0x3871, 0x3050,},
        {0x488f, 0x488f, 0x50b0, 0x5090, 0x50b0, 0x60af, 0x60af, 0x4978, 0x4957, 0x4116, 0x40d6, 0x38b5, 0x3895, 0x3895, 0x3875, 0x3875, 0x3875, 0x3875, 0x3874, 0x3874, 0x4093, 0x4073, 0xf79e, 0x4073, 0x4073, 0xf7df, 0x3871, 0xf7be, 0x3870, 0x3070,},
        {0x384e, 0x488f, 0x488f, 0x488f, 0x5090, 0x58b0, 0x60af, 0x608e, 0x4977, 0x4116, 0x40f6, 0x40d5, 0x40b5, 0x3895, 0x3875, 0x4074, 0x4095, 0x3874, 0x3874, 0x4072, 0x4093, 0x4093, 0xffdf, 0x4073, 0x3872, 0xf79d, 0x3871, 0xffff, 0x3070, 0x3050,},
        {0x384e, 0x488f, 0x488f, 0x508f, 0x508f, 0x5090, 0x5890, 0x68af, 0x60af, 0x4936, 0x48f6, 0x40d5, 0x40b5, 0x4095, 0x4095, 0x4095, 0x4074, 0x4074, 0x3874, 0x4092, 0x4092, 0x4093, 0x286c, 0x286d, 0x3871, 0x306e, 0x3871, 0x284d, 0x3050, 0x3050,},
        {0x384e, 0x384e, 0x488f, 0x5090, 0x5090, 0x5090, 0x5090, 0x5890, 0x68ae, 0x4956, 0x4916, 0x48f5, 0x40b5, 0x48b5, 0x40b5, 0x4094, 0x4094, 0x4094, 0x4094, 0x4092, 0x4893, 0x4093, 0x4093, 0x4092, 0x3871, 0x3871, 0x3870, 0x3870, 0x3050, 0x3050,},
        {0x384e, 0x384e, 0x384e, 0x508f, 0x5090, 0x5090, 0x5090, 0x5890, 0x58b0, 0x608e, 0x5137, 0x50f6, 0x48d6, 0x48b5, 0x48b5, 0x48b4, 0x4094, 0x4094, 0x48b2, 0x4892, 0x4893, 0x4893, 0xf79e, 0x3871, 0x3871, 0xea06, 0x3871, 0xf7be, 0x3050, 0x3050,},
        {0x384e, 0x384e, 0x386e, 0x386e, 0x386e, 0x5090, 0x5090, 0x5090, 0x5890, 0x5890, 0x68ae, 0x5116, 0x58f6, 0x50d6, 0x50b5, 0x48b4, 0x4894, 0x4094, 0x48b2, 0x4892, 0x48b3, 0x4893, 0xffff, 0x4091, 0x4071, 0xffdf, 0x3871, 0xffff, 0x3050, 0x3050,},
        {0x304c, 0x384e, 0x384e, 0x386e, 0x384e, 0x384e, 0x5090, 0x5090, 0x5090, 0x5890, 0x588f, 0x5937, 0x5916, 0x58f6, 0x58f5, 0x50d5, 0x48b5, 0x50b4, 0x50b2, 0x48b2, 0x48b2, 0x4893, 0x4090, 0x3870, 0x4071, 0x3871, 0x3851, 0x304f, 0x304f, 0x304f,},
        {0x302c, 0x302c, 0x384d, 0x384e, 0x386e, 0x386e, 0x488f, 0x4870, 0x5070, 0x5870, 0x5890, 0x6958, 0x6137, 0x6116, 0x58f5, 0x50f5, 0x50d5, 0x50b4, 0x50b2, 0x50b2, 0x48b3, 0x48b3, 0xef7d, 0x4071, 0x4071, 0xd000, 0x3871, 0xf79d, 0x3050, 0x3050,},
        {0x304c, 0x302c, 0x302c, 0x384e, 0x384e, 0x384e, 0x386e, 0x486f, 0x486f, 0x5070, 0x588f, 0x586f, 0x6977, 0x6956, 0x6116, 0x58f6, 0x50d5, 0x50d4, 0x50d3, 0x50b2, 0x48b2, 0x48b3, 0xf79e, 0x4091, 0x4092, 0xc800, 0x3871, 0xf7be, 0x3050, 0x3050,},
        {0x302c, 0x302c, 0x302c, 0x302c, 0x304c, 0x304d, 0x386e, 0x406f, 0x406f, 0x404f, 0x588f, 0x506f, 0x71b8, 0x6957, 0x6956, 0x6136, 0x5915, 0x58f5, 0x58d3, 0x50b2, 0x50b3, 0x48b3, 0x4091, 0x4071, 0x4092, 0x4071, 0x3871, 0x3850, 0x3070, 0x3050,},
        {0x282c, 0x302c, 0x304c, 0x302c, 0x302c, 0x302c, 0x382d, 0x384e, 0x404e, 0x404f, 0x406e, 0x586f, 0x5890, 0x71b7, 0x6957, 0x6137, 0x6115, 0x58d3, 0x58d3, 0x50b2, 0x50b3, 0x48b2, 0xffdf, 0xffff, 0x386f, 0x386f, 0x3871, 0x304f, 0xd65b, 0xffff,},
        {0x282c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x304d, 0x386e, 0x384e, 0x384e, 0x384e, 0x404e, 0x5890, 0x79b7, 0x7197, 0x6957, 0x6135, 0x60f3, 0x58d3, 0x58d3, 0x50d3, 0x50b3, 0xf79e, 0x4872, 0x4071, 0xffff, 0x3871, 0xf79e, 0x3870, 0x3050,},
        {0x282c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x384d, 0x382d, 0x382d, 0x384e, 0x384e, 0x586f, 0x8218, 0x71b7, 0x6976, 0x6935, 0x6114, 0x6113, 0x58f3, 0x58d3, 0x5091, 0xe73d, 0x4892, 0x4071, 0xffff, 0x3871, 0xffdf, 0x3870, 0x3050,},
        {0x202a, 0x282c, 0x302c, 0x304c, 0x302c, 0x302c, 0x302c, 0x304c, 0x382d, 0x382d, 0x382d, 0x382d, 0x382e, 0x5870, 0x81f7, 0x79b6, 0x6975, 0x6934, 0x6113, 0x58f3, 0x50d2, 0x5091, 0x4891, 0x4871, 0x4071, 0x4071, 0x4071, 0x3870, 0x3050, 0x304f,},
        {0x202b, 0x202a, 0x202b, 0x302c, 0x302c, 0x282c, 0x302c, 0x304c, 0x302d, 0x302d, 0x384d, 0x382d, 0x382d, 0x5890, 0x8a37, 0x81f6, 0x7195, 0x6954, 0x6113, 0x6113, 0x58d1, 0x50d1, 0xffff, 0xffff, 0x4891, 0x4091, 0x4051, 0x284c, 0x304d, 0xffff,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x302c, 0x304d, 0x304c, 0x304c, 0x302d, 0x382d, 0x382d, 0x404e, 0x8a76, 0x8216, 0x79b5, 0x7174, 0x6953, 0x60f2, 0x60d1, 0x58d1, 0x3f9,  0x4892, 0x4891, 0xffdf, 0x4071, 0xf79e, 0x3870, 0x304f,},
        {0x202a, 0x202a, 0x202b, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x302c, 0x302c, 0x384d, 0x384d, 0x404e, 0x5070, 0x8a55, 0x81d4, 0x7993, 0x6952, 0x6911, 0x60d1, 0x58d2, 0x769f, 0x4891, 0x4891, 0xf7be, 0x4070, 0xffdf, 0x3870, 0x384f,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x302c, 0x302d, 0x382d, 0x402e, 0x5870, 0x9295, 0x8a14, 0x7993, 0x7152, 0x6911, 0x60f1, 0x58d1, 0x50b1, 0x5091, 0x4890, 0x4090, 0x4070, 0xffff, 0x386f, 0x304f,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2009, 0x302c, 0x382d, 0x382d, 0x484f, 0x92b5, 0x8a13, 0x81d3, 0x7972, 0x7132, 0x60f1, 0x60d1, 0x58b1, 0x5091, 0x4890, 0x4070, 0x4070, 0x406f, 0x384e, 0x306e,},
        {0x1808, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x1829, 0x302c, 0x382d, 0x382d, 0x484f, 0x5070, 0x9233, 0x89d3, 0x8192, 0x7131, 0x6912, 0x60f1, 0xf79e, 0x50b1, 0x5091, 0x39e8, 0x4890, 0xf7be, 0x386f, 0x386f,},
        {0x1808, 0x1807, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x2029, 0x1829, 0x302c, 0x382d, 0x404e, 0x5070, 0x99f2, 0x91d2, 0x89b3, 0x7952, 0x7132, 0x68f1, 0xffdf, 0x58b1, 0x5091, 0xf7be, 0x4870, 0xffdf, 0x386f, 0x386f,},
        {0x1807, 0x1807, 0x1827, 0x1007, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x1829, 0x1829, 0x302c, 0x382d, 0x404e, 0x484f, 0x91b1, 0x99b2, 0x9172, 0x8952, 0x7912, 0x70f2, 0xf77e, 0x60b1, 0xffff, 0x488e, 0x4870, 0x9c95, 0x386f, 0x384e,},
        {0x1808, 0x1807, 0x1007, 0x1007, 0x1007, 0x202a, 0x202a, 0x202a, 0x2029, 0x2029, 0x1829, 0x1829, 0x1829, 0x382d, 0x404e, 0x484f, 0x5871, 0x9951, 0x9952, 0x9132, 0x8912, 0x78f2, 0x68b1, 0x68b2, 0x6091, 0x5870, 0x5070, 0x486f, 0x404f, 0x384e,},
        {0x1808, 0x1807, 0x1807, 0x1007, 0x1007, 0x1006, 0x2029, 0x202a, 0x1829, 0x2029, 0x1829, 0x1829, 0x1829, 0x302c, 0x404d, 0x484f, 0x5830, 0x8094, 0x9913, 0x90f3, 0x88d3, 0x80b2, 0x769f, 0x6871, 0x6071, 0xa5fd, 0x5070, 0x769f, 0x665f, 0x384e,},
        {0x1808, 0x1807, 0x1827, 0x1007, 0x1006, 0x1006, 0x1026, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x382d, 0x484e, 0x5850, 0x6031, 0x8093, 0x90d3, 0x88b3, 0x80b2, 0x55dd, 0x7072, 0x6871, 0xffbf, 0x5850, 0x55fd, 0x30ab, 0x384e,},
        {0x1807, 0x1807, 0x1007, 0x1007, 0x1007, 0x1026, 0x1006, 0x1006, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x484e, 0x504f, 0x5830, 0x8074, 0x8054, 0x8054, 0x7833, 0x584e, 0x504e, 0x504d, 0x584f, 0x5870, 0x406d, 0x404d, 0x304d,},
        {0x1807, 0x1007, 0x1007, 0x1007, 0x1006, 0x1026, 0x1026, 0x1006, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x502f, 0x5850, 0x6832, 0x7833, 0x7833, 0x7853, 0x7053, 0x7032, 0x6851, 0x5850, 0x5850, 0x504f, 0x406e, 0x302d,},
        {0x1807, 0x1007, 0x1007, 0x1007, 0x1026, 0x1006, 0x1026, 0x1026, 0x1006, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x384d, 0x5830, 0x6831, 0x7053, 0x7032, 0x7053, 0x7052, 0x6852, 0x6851, 0x6051, 0x584f, 0x504f, 0x384e, 0x304d,},
};

void main(void) {
    Mcu_InitIo();
    Lcd_Initial();
    bl = 1;
    Lcd_SingleColour((int) RED);
    Mcu_DelayMs(1000);
    Lcd_ShowImageEncoding565(screen_shot, 0, 0, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, 0, IMAGE_WIDTH * 2, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT, IMAGE_WIDTH, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT * 2, 0, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT * 2, IMAGE_WIDTH * 2, IMAGE_HEIGHT, IMAGE_WIDTH);
    int offset = 0;
    TextStyle text_style = {LCD1602, GREEN, BLACK, 1};
//    while (1) {
//        Lcd_ShowImageEncoding565(screen_shot, 0, 0, 30, 30);
//        Mcu_DelayMs(300);
//    }
    while (1) {
        //show_all_chars(offset++);
        Lcd_ShowMessage1602("Temperature: -87'F.", 18, 0, 0, &text_style);
        Lcd_ShowMessage1602("Alice: ~Emm~", 12, 0, LCD1602HEIGHT + 1, &text_style);
        Lcd_ShowMessage1602("Bob: Yep!", 9, 0, LCD1602HEIGHT * 2 + 2, &text_style);
        Mcu_DelayMs(5000);
    }
}


