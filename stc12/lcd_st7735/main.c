// ST7735 driver
#include<stc12.h>
#include<string.h>

#define uchar unsigned char
#define uint unsigned int


// hardware: STC12C5608AD
// crystal frequency: 32MHZ
//---------------------------wiring illustration-------------------------------------//
#define bl        P2_2//backlight, maybe wired to high or pwm
#define scl       P2_3//spi clock
#define sda       P2_4//spi data
#define rs        P2_5//d/c(data/command)
#define cs        P2_6//chip selection, wired to ce
#define reset     P2_7//reset pin or high

// set the origin point of the lcd
#define OFFSET_X 2
#define OFFSET_Y 3
#define SIZE_X 128
#define SIZE_Y 130

// commonly used colors, only for 16bits(RGB565)
#define RED     0xf800
#define GREEN   0x07e0
#define BLUE    0x001f
#define WHITE   0xffff
#define BLACK   0x0000
#define YELLOW  0xFFE0
#define GRAY0   0xEF7D
#define GRAY1   0x8410
#define GRAY2   0x4208

void Mcu_DelayMs(uint time) {
    uint i, j;
    for (i = 0; i < time; i++)
        for (j = 0; j < 250; j++);
}


// send 8 bits by pseudo-spi
inline void Mcu_WriteData(uchar Data) {
    uchar i = 0;
    for (i = 8; i > 0; i--) {
        if (Data & 0x80)
            sda = 1;
        else
            sda = 0;
        scl = 0;
        scl = 1;
        Data <<= 1;
    }
}

// write command(8bits) to lcd
inline void Lcd_WriteIndex(uchar Data) {
    cs = 0;
    rs = 0;
    Mcu_WriteData(Data);
    cs = 1;
}

// write data(8bits) to lcd
void Lcd_WriteData(uchar Data) {
    uchar i = 0;
    cs = 0;
    rs = 1;
    Mcu_WriteData(Data);
    cs = 1;
}

// write data(16bits) to lcd
void Lcd_WriteData_16Bit(uint Data) {
    uchar i = 0;
    cs = 0;
    rs = 1;
    Mcu_WriteData(Data >> 8);         // write msb 8
    Mcu_WriteData(Data);                    // write lsb 8
    cs = 1;

}

void Lcd_Reset() {
    reset = 0;
    Mcu_DelayMs(100);
    reset = 1;
    Mcu_DelayMs(100);
}

void Mcu_InitIo() {
#ifdef MCU_STC12
    P2M1 &= ~(1 << 2), P2M0 |= (1 << 2);
#elifdef MCU_STC89

#elif MCU_ATMEGA

#endif
}

void Lcd_Initial() {
    Lcd_Reset();// reset before LCD Init.

    Lcd_WriteIndex(0x11);// sleep exit & booster on
    Mcu_DelayMs(120);

    Lcd_WriteIndex(0x20); // display inversion off
    // Lcd_WriteIndex(0x21); // display inversion on

    Lcd_WriteIndex(0xB1); // frame rate control. in normal mode(full colors)
    Lcd_WriteData(0x05);
    Lcd_WriteData(0x3A);
    Lcd_WriteData(0x3A);

    Lcd_WriteIndex(0xB2);
    Lcd_WriteData(0x05);
    Lcd_WriteData(0x3A);
    Lcd_WriteData(0x3A);

    Lcd_WriteIndex(0xB3);
    Lcd_WriteData(0x05);
    Lcd_WriteData(0x3A);
    Lcd_WriteData(0x3A);
    Lcd_WriteData(0x05);
    Lcd_WriteData(0x3A);
    Lcd_WriteData(0x3A);

    Lcd_WriteIndex(0xB4); // display inversion mode control
    Lcd_WriteData(0x03);

    Lcd_WriteIndex(0xC1); // power control: vgh=9.8;vgl=-7.35
    Lcd_WriteData(0xC0);

    Lcd_WriteIndex(0xC2);
    Lcd_WriteData(0x0D);
    Lcd_WriteData(0x00);

    Lcd_WriteIndex(0xC3);
    Lcd_WriteData(0x8D);
    Lcd_WriteData(0x6A);

    Lcd_WriteIndex(0xC4);
    Lcd_WriteData(0x8D);
    Lcd_WriteData(0xEE);

    Lcd_WriteIndex(0xE0); // gamma correction, '+' polar
    Lcd_WriteData(0x10);
    Lcd_WriteData(0x0E);
    Lcd_WriteData(0x02);
    Lcd_WriteData(0x03);
    Lcd_WriteData(0x0E);
    Lcd_WriteData(0x07);
    Lcd_WriteData(0x02);
    Lcd_WriteData(0x07);
    Lcd_WriteData(0x0A);
    Lcd_WriteData(0x12);
    Lcd_WriteData(0x27);
    Lcd_WriteData(0x37);
    Lcd_WriteData(0x00);
    Lcd_WriteData(0x0D);
    Lcd_WriteData(0x0E);
    Lcd_WriteData(0x10);

    Lcd_WriteIndex(0xE1); // gamma correction, '-' polar
    Lcd_WriteData(0x10);
    Lcd_WriteData(0x0E);
    Lcd_WriteData(0x03);
    Lcd_WriteData(0x03);
    Lcd_WriteData(0x0F);
    Lcd_WriteData(0x06);
    Lcd_WriteData(0x02);
    Lcd_WriteData(0x08);
    Lcd_WriteData(0x0A);
    Lcd_WriteData(0x13);
    Lcd_WriteData(0x26);
    Lcd_WriteData(0x36);
    Lcd_WriteData(0x00);
    Lcd_WriteData(0x0D);
    Lcd_WriteData(0x0E);
    Lcd_WriteData(0x10);

    Lcd_WriteIndex(0x3A); // color mode
    Lcd_WriteData(0x05); // 16-bit/pixel

    Lcd_WriteIndex(0x36); // memory data access control
    Lcd_WriteData(0xC8);

    Lcd_WriteIndex(0x29); // display on

}


void Lcd_SetRegion(uint x_start, uint y_start, uint x_end, uint y_end) {

    Lcd_WriteIndex(0x2a);
    Lcd_WriteData(0x00);
    Lcd_WriteData(x_start + OFFSET_X);
    Lcd_WriteData(0x00);
    Lcd_WriteData(x_end + OFFSET_X);

    Lcd_WriteIndex(0x2b);
    Lcd_WriteData(0x00);
    Lcd_WriteData(y_start + OFFSET_Y);
    Lcd_WriteData(0x00);
    Lcd_WriteData(y_end + OFFSET_Y);
    Lcd_WriteIndex(0x2c);
}


void Lcd_SingleColour(int color) {
    uchar i, j;
    Lcd_SetRegion(0, 0, SIZE_X, SIZE_Y);
    for (i = 0; i < SIZE_Y; i++)
        for (j = 0; j < SIZE_X; j++)
            Lcd_WriteData_16Bit(color);
}

void show_gradual() {
    Lcd_SingleColour((int) WHITE);
    int w = 142, h = 128;
    Lcd_SetRegion(-31, 0, 111, 160);
    for (int i = 0; i < w; i++) {
        for (int j = 0; j < h; j++) {
            if (i > w / 2) {
                Lcd_WriteData_16Bit((int) (0.0014 * i * j));
            } else {
                Lcd_WriteData_16Bit(((int) (0.0014 * i * j * 2)) << 11);
            }
        }
    }
}

#define LCD1602WIDTH 5
#define LCD1602HEIGHT 7
__code uchar lcd1602[96][LCD1602HEIGHT] = {
        //' '=20h
        {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
        //‘!’=21h
        {0x04, 0x04, 0x04, 0x04, 0x00, 0x00, 0x04},
        //‘“‘=22h
        {0x0a, 0x0a, 0x0a, 0x00, 0x00, 0x00, 0x00},
        //'#’=23h
        {0x0a, 0x0a, 0x1f, 0x0a, 0x1f, 0x0a, 0x0a},
        //‘$’=24h
        {0x04, 0x0f, 0x14, 0x0e, 0x05, 0x1e, 0x04},
        //‘%’=25h
        {0x18, 0x19, 0x02, 0x04, 0x08, 0x13, 0x03},
        //'&'=26h
        {0x0c, 0x12, 0x14, 0x08, 0x15, 0x12, 0x0d},
        //'''=27h
        {0x18, 0x08, 0x10, 0x00, 0x00, 0x00, 0x00},
        //'('=28h
        {0x02, 0x04, 0x08, 0x08, 0x08, 0x04, 0x02},
        //')'=29h
        {0x08, 0x04, 0x02, 0x02, 0x02, 0x04, 0x08},
        //'*'=2ah
        {0x00, 0x04, 0x15, 0x0e, 0x15, 0x04, 0x00},
        //'+'=2bh
        {0x00, 0x04, 0x04, 0x1f, 0x04, 0x04, 0x00},
        //','=2ch
        {0x00, 0x00, 0x00, 0x00, 0x0c, 0x04, 0x08},
        //'-'=2dh
        {0x00, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x00},
        //'.'=2eh
        {0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x0c},
        //'/'=2fh
        {0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x00},
        //‘0’=30h
        {0x0e, 0x11, 0x13, 0x15, 0x19, 0x11, 0x0e},
        //‘1’=31h
        {0x04, 0x0c, 0x04, 0x04, 0x04, 0x04, 0x0e},
        //‘2’=32h
        {0x0e, 0x11, 0x01, 0x02, 0x04, 0x08, 0x1f},
        //‘3’=33h
        {0x1f, 0x02, 0x04, 0x02, 0x01, 0x11, 0x0e},
        //‘4’=34h
        {0x02, 0x06, 0x0a, 0x12, 0x1f, 0x02, 0x02},
        //‘5’=35h
        {0x1f, 0x10, 0x1e, 0x01, 0x01, 0x11, 0x0e},
        //‘6’=36h
        {0x06, 0x08, 0x10, 0x1e, 0x11, 0x11, 0x0e},
        //‘7’=37h
        {0x1f, 0x01, 0x02, 0x04, 0x08, 0x08, 0x08},
        //‘8’=38h
        {0x0e, 0x11, 0x11, 0x0e, 0x11, 0x11, 0x0e},
        //‘9’=39h
        {0x0e, 0x11, 0x11, 0x0f, 0x01, 0x02, 0x0c},
        //':'=3ah
        {0x00, 0x0c, 0x0c, 0x00, 0x0c, 0x0c, 0x00},
        //';'=3bh
        {0x00, 0x0c, 0x0c, 0x00, 0x0c, 0x04, 0x08},
        //'<'=3ch
        {0x02, 0x04, 0x08, 0x10, 0x08, 0x04, 0x02},
        //'='=3dh
        {0x00, 0x00, 0x1f, 0x00, 0x1f, 0x00, 0x00},
        //'>'=3eh
        {0x08, 0x04, 0x02, 0x01, 0x02, 0x04, 0x08},
        //'?'=3fh
        {0x0e, 0x11, 0x01, 0x02, 0x04, 0x00, 0x04},
        //'@'=40h
        {0x0e, 0x11, 0x01, 0x0d, 0x15, 0x15, 0x0e},
        //'A'=41h
        {0x0e, 0x11, 0x11, 0x11, 0x1f, 0x11, 0x11},
        //'B'=42h
        {0x1e, 0x11, 0x11, 0x1e, 0x11, 0x11, 0x1e},
        //'C'=43h
        {0x0e, 0x11, 0x10, 0x10, 0x10, 0x11, 0x0e},
        //'D'=44h
        {0x1c, 0x12, 0x11, 0x11, 0x11, 0x12, 0x1c},
        //'E'=45h
        {0x1f, 0x10, 0x10, 0x1e, 0x10, 0x10, 0x1f},
        //'F'=46h
        {0x1f, 0x10, 0x10, 0x1e, 0x10, 0x10, 0x10},
        //'G'=47h
        {0x0e, 0x11, 0x10, 0x17, 0x11, 0x11, 0x0f},
        //'H'=48h
        {0x11, 0x11, 0x11, 0x1f, 0x11, 0x11, 0x11},
        //'I'=49h
        {0x0e, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0e},
        //'J'=4ah
        {0x07, 0x02, 0x02, 0x02, 0x02, 0x12, 0x0c},
        //'K'=4bh
        {0x11, 0x12, 0x14, 0x18, 0x14, 0x12, 0x11},
        //'L'=4ch
        {0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x1f},
        //'M'=4dh
        {0x11, 0x1b, 0x15, 0x15, 0x11, 0x11, 0x11},
        //'N'=4eh
        {0x11, 0x11, 0x19, 0x15, 0x13, 0x11, 0x11},
        //'O'=4fh
        {0x0e, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0e},
        //'P'=50h
        {0x1e, 0x11, 0x11, 0x1e, 0x10, 0x10, 0x10},
        //'Q'=51h
        {0x0e, 0x11, 0x11, 0x11, 0x15, 0x12, 0x0d},
        //'R'=52h
        {0x1e, 0x11, 0x11, 0x1e, 0x14, 0x12, 0x11},
        //'S'=53h
        {0x0f, 0x10, 0x10, 0x0e, 0x01, 0x01, 0x1e},
        //'T'=54h
        {0x1f, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04},
        //'U'=55h
        {0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0e},
        //'V'=56h
        {0x11, 0x11, 0x11, 0x11, 0x11, 0x0a, 0x04},
        //'W'=57h
        {0x11, 0x11, 0x11, 0x15, 0x15, 0x15, 0x0a},
        //'X'=58h
        {0x11, 0x11, 0x0a, 0x01, 0x0a, 0x11, 0x11},
        //'Y'=59h
        {0x11, 0x11, 0x11, 0x0a, 0x04, 0x04, 0x04},
        //'Z'=5ah
        {0x1f, 0x01, 0x02, 0x04, 0x08, 0x10, 0x1f},
        //'['=5bh
        {0x0e, 0x08, 0x08, 0x08, 0x08, 0x08, 0x0e},
        //'\'=5ch
        {0x00, 0x10, 0x08, 0x04, 0x02, 0x01, 0x00},
        //']'=5dh
        {0x0e, 0x02, 0x02, 0x02, 0x02, 0x02, 0x0e},
        //'^'=5eh
        {0x04, 0x0a, 0x11, 0x00, 0x00, 0x00, 0x00},
        //'_'=5fh
        {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f},
        //'`'=60h
        {0x08, 0x04, 0x02, 0x00, 0x00, 0x00, 0x00},
        //'a'=61h
        {0x00, 0x00, 0x0e, 0x01, 0x0f, 0x11, 0x0f},
        //'b'=62h
        {0x10, 0x10, 0x16, 0x19, 0x11, 0x11, 0x1e},
        //'c'=63h
        {0x00, 0x00, 0x0e, 0x10, 0x10, 0x11, 0x0e},
        //'d'=64h
        {0x01, 0x01, 0x0d, 0x13, 0x11, 0x11, 0x0f},
        //'e'=65h
        {0x00, 0x00, 0x0e, 0x11, 0x1f, 0x10, 0x0e},
        //'f'=66h
        {0x06, 0x09, 0x08, 0x1c, 0x08, 0x08, 0x08},
        //'g'=67h
        {0x00, 0x0f, 0x11, 0x11, 0x0f, 0x01, 0x0e},
        //'h'=68h
        {0x10, 0x10, 0x16, 0x19, 0x11, 0x11, 0x11},
        //'i'=69h
        {0x04, 0x00, 0x0c, 0x04, 0x04, 0x04, 0x0e},
        //'j'=6ah
        {0x02, 0x00, 0x06, 0x02, 0x02, 0x12, 0x0c},
        //'k'=6bh
        {0x10, 0x10, 0x12, 0x14, 0x18, 0x14, 0x12},
        //'l'=6ch
        {0x0c, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0e},
        //'m'=6dh
        {0x00, 0x00, 0x1a, 0x15, 0x15, 0x11, 0x11},
        //'n'=6eh
        {0x00, 0x00, 0x16, 0x19, 0x11, 0x11, 0x11},
        //'o'=6fh
        {0x00, 0x00, 0x0e, 0x11, 0x11, 0x11, 0x0e},
        //'p'=70h
        {0x00, 0x00, 0x1e, 0x11, 0x1e, 0x10, 0x10},
        //'q'=71h
        {0x00, 0x00, 0x0d, 0x13, 0x0f, 0x01, 0x01},
        //'r'=72h
        {0x00, 0x00, 0x16, 0x19, 0x10, 0x10, 0x10},
        //'s'=73h
        {0x00, 0x00, 0x0e, 0x10, 0x0e, 0x01, 0x1e},
        //'t'=74h
        {0x08, 0x08, 0x1c, 0x08, 0x08, 0x09, 0x06},
        //'u'=75h
        {0x00, 0x00, 0x11, 0x11, 0x11, 0x13, 0x0d},
        //'v'=76h
        {0x00, 0x00, 0x11, 0x11, 0x11, 0x0a, 0x04},
        //'w'=77h
        {0x00, 0x00, 0x11, 0x11, 0x11, 0x15, 0x0a},
        //'x'=78h
        {0x00, 0x00, 0x11, 0x0a, 0x04, 0x0a, 0x11},
        //'y'=79h
        {0x00, 0x00, 0x11, 0x11, 0x0f, 0x01, 0x0e},
        //'z'=7ah
        {0x00, 0x00, 0x1f, 0x02, 0x04, 0x08, 0x1f},
        //'{'=7bh
        {0x02, 0x04, 0x04, 0x08, 0x04, 0x04, 0x02},
        //'|'=7ch
        {0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04},
        //'}'=7dh
        {0x08, 0x04, 0x04, 0x02, 0x04, 0x04, 0x08},
        //'~'=7eh
        {0x00, 0x00, 0x08, 0x15, 0x02, 0x00, 0x00},
};
enum CharSet {
    LCD1602 = 1,
    LCD8x8 = 2,
    LCD16x16 = 3,
};
typedef struct {
    enum CharSet char_set;
    int foreground_color;
    int background_color;
    uchar char_gap;
} TextStyle;

void Lcd_ShowLcd1602Char(int x, int y, const uchar data, TextStyle *text_style) {
    Lcd_SetRegion(x, y, x + LCD1602WIDTH - 1 + text_style->char_gap, y + LCD1602HEIGHT);
    char *c = lcd1602[data - ' '];
    for (int i = 0; i < LCD1602HEIGHT; i++) {
        char d = *(c + i);
        for (int j = 0; j < LCD1602WIDTH + text_style->char_gap; j++) {
            int color = text_style->background_color;
            if (d & 0x10) { color = text_style->foreground_color; }
            Lcd_WriteData_16Bit(color);
            d <<= 1;
        }
    }
}

void Lcd_ShowMessage1602(char *message, uint len, int x, int y, TextStyle *text_style) {
    int char_width = LCD1602WIDTH + text_style->char_gap;
    for (uint i = 0; i < len; i++) {
        uchar data = message[i];
        Lcd_ShowLcd1602Char(x + char_width * i, y, data, text_style);
    }
}

#define IMAGE_WIDTH 40
#define IMAGE_HEIGHT 40
// mind the image eeprom/ram usage!
// there is a python tool to generate the image data included in this repo.
__code uint screen_shot[IMAGE_HEIGHT][IMAGE_WIDTH] = {
        {0x488f, 0x508f, 0x5090, 0x50b0, 0x58b0, 0x58b0, 0x588f, 0x78ee, 0x4179, 0x4158, 0x4117, 0x38d7, 0x38d7, 0x38d7, 0x38b7, 0x3896, 0x3896, 0x3896, 0x3896, 0x3896, 0x3876, 0x3875, 0x3875, 0x3855, 0x3875, 0x2871, 0x204e, 0x2871, 0x3893, 0xce3a, 0x312d, 0x286d, 0x3894, 0x9475, 0x3072, 0x3871, 0x9cb5, 0xffff, 0x3051, 0x3050,},
        {0x488f, 0x488f, 0x50af, 0x50b0, 0x50b0, 0x58af, 0x60b0, 0x70ce, 0x5156, 0x4958, 0x4137, 0x4117, 0x40f6, 0x38d7, 0x38b6, 0x38b6, 0x3896, 0x3896, 0x3875, 0x3875, 0x3875, 0x3875, 0x3875, 0x3875, 0x3875, 0x3875, 0x3075, 0x3873, 0x3873, 0x3893, 0x3872, 0x3070, 0x4094, 0x3872, 0x3871, 0x306f, 0x3050, 0x306f, 0x284e, 0x284e,},
        {0x488f, 0x488f, 0x488f, 0x508f, 0x508f, 0x50b0, 0x58af, 0x60af, 0x70ce, 0x4978, 0x4137, 0x4117, 0x40f6, 0x40d6, 0x38d6, 0x38b6, 0x3896, 0x3895, 0x3895, 0x3875, 0x3875, 0x3875, 0x3875, 0x3874, 0x3875, 0x3874, 0x3872, 0x3873, 0x3873, 0x3893, 0xe73c, 0x3893, 0x4093, 0xf7be, 0x3871, 0x3871, 0xf79e, 0x3851, 0x3050, 0x3050,},
        {0x386e, 0x488f, 0x488f, 0x488f, 0x508f, 0x508f, 0x50b0, 0x60af, 0x608e, 0x4998, 0x4957, 0x4937, 0x4116, 0x40f6, 0x40b6, 0x38b6, 0x3895, 0x3895, 0x3875, 0x3875, 0x3895, 0x3895, 0x3875, 0x3874, 0x3874, 0x3854, 0x4092, 0x3892, 0x4093, 0x4093, 0x0,    0x4093, 0x3071, 0xffff, 0x3871, 0x3871, 0xf7be, 0xef7d, 0x3050, 0x3050,},
        {0x384e, 0x48af, 0x48af, 0x488f, 0x488f, 0x508f, 0x5090, 0x588f, 0x60af, 0x60af, 0x4997, 0x4956, 0x4116, 0x40f6, 0x40d5, 0x40b5, 0x40b5, 0x3895, 0x3895, 0x3875, 0x4075, 0x4074, 0x3874, 0x3874, 0x3874, 0x3874, 0x4092, 0x4093, 0x4093, 0x4093, 0xf7be, 0x4093, 0x3872, 0xae15, 0x3871, 0x3871, 0xffff, 0xf7be, 0x3050, 0x3050,},
        {0x386e, 0x488f, 0x50af, 0x488f, 0x508f, 0x5090, 0x5090, 0x50b0, 0x60af, 0x60ae, 0x68ae, 0x4977, 0x4936, 0x4916, 0x48f6, 0x40d6, 0x4095, 0x4095, 0x4075, 0x3874, 0x4074, 0x4094, 0x4074, 0x4074, 0x4074, 0x4092, 0x4072, 0x4072, 0x4072, 0xd65c, 0xffff, 0x4912, 0x3871, 0xffff, 0x3871, 0x3871, 0x83d3, 0x6b12, 0x3050, 0x3050,},
        {0x384e, 0x386e, 0x488f, 0x488f, 0x488f, 0x508f, 0x5090, 0x5070, 0x58b0, 0x58b0, 0x68ae, 0x68ae, 0x4936, 0x4916, 0x48f5, 0x40d5, 0x40b5, 0x4095, 0x40b5, 0x40b5, 0x4094, 0x4094, 0x4094, 0x4094, 0x3874, 0x4092, 0x4092, 0x4093, 0x4092, 0x4092, 0x9c76, 0xffff, 0x3871, 0x3871, 0x3871, 0xffff, 0x306f, 0x284d, 0xffdf, 0x8bf5,},
        {0x384e, 0x386e, 0x384e, 0x488f, 0x488f, 0x488f, 0x5090, 0x5090, 0x5090, 0x58b0, 0x58b0, 0x68ae, 0x4956, 0x5136, 0x5116, 0x48d5, 0x48b5, 0x48b5, 0x4095, 0x4895, 0x4094, 0x4895, 0x4094, 0x4094, 0x4094, 0x4892, 0x4892, 0x4893, 0x4093, 0x4093, 0x4072, 0x3871, 0x3871, 0xf7be, 0x3871, 0x3870, 0xf79e, 0x3050, 0x3050, 0x3050,},
        {0x384e, 0x386e, 0x384e, 0x386e, 0x508f, 0x508f, 0x5090, 0x5090, 0x5090, 0x50b0, 0x5890, 0x5890, 0x608e, 0x68af, 0x5116, 0x50f6, 0x48d6, 0x48b5, 0x48b5, 0x48b5, 0x48b5, 0x4894, 0x4094, 0x4094, 0x48b2, 0x4892, 0x4892, 0x48b3, 0x4893, 0x4093, 0xf79e, 0x4091, 0x3871, 0xe206, 0x3871, 0x3871, 0xf7be, 0xef7d, 0x3050, 0x3070,},
        {0x304d, 0x304e, 0x386e, 0x384e, 0x386e, 0x384e, 0x5090, 0x5090, 0x5090, 0x5090, 0x5090, 0x5890, 0x5890, 0x68ae, 0x5937, 0x50f6, 0x58f6, 0x50d6, 0x50d5, 0x48b5, 0x48b4, 0x48b4, 0x4894, 0x4094, 0x4892, 0x48b2, 0x48b2, 0x48b3, 0x4093, 0x4093, 0xf7be, 0x4071, 0x4071, 0x2ce9, 0x3871, 0x3871, 0xffdf, 0xf7be, 0x3050, 0x3050,},
        {0x304d, 0x384e, 0x386e, 0x386e, 0x386e, 0x386e, 0x384e, 0x5090, 0x5090, 0x5090, 0x5090, 0x5890, 0x5890, 0x588f, 0x5957, 0x5917, 0x58f6, 0x58d6, 0x50d5, 0x50d5, 0x50b5, 0x48b4, 0x48b5, 0x48b4, 0x48b2, 0x48b2, 0x48b2, 0x48b3, 0x48b3, 0x4092, 0x3890, 0x4071, 0x3871, 0x3871, 0x3871, 0x3871, 0xffff, 0x284e, 0x3050, 0x3050,},
        {0x302c, 0x304c, 0x384d, 0x304d, 0x304d, 0x384e, 0x384e, 0x384e, 0x5090, 0x5070, 0x5090, 0x5070, 0x5890, 0x586f, 0x68af, 0x6137, 0x5917, 0x5916, 0x58f6, 0x50f5, 0x50d5, 0x48b5, 0x48d5, 0x50b4, 0x50b2, 0x50b2, 0x50b2, 0x48b3, 0x48b2, 0xdedc, 0x386f, 0xffff, 0x4071, 0x4071, 0x4071, 0x304f, 0x306f, 0x284e, 0xffff, 0x7313,},
        {0x302c, 0x304c, 0x302c, 0x386e, 0x384e, 0x386e, 0x386e, 0x384e, 0x488f, 0x4890, 0x5090, 0x5070, 0x5870, 0x586f, 0x586f, 0x6158, 0x6137, 0x6136, 0x6116, 0x58f6, 0x50d5, 0x50d5, 0x50d4, 0x50d4, 0x50b2, 0x50b2, 0x50b2, 0x50b3, 0x48b3, 0x4093, 0x4091, 0x4071, 0x4071, 0xc800, 0x4071, 0x3851, 0xf79d, 0x3070, 0x3050, 0x3050,},
        {0x302c, 0x304c, 0x304c, 0x304e, 0x384e, 0x384e, 0x384e, 0x386e, 0x386e, 0x486f, 0x486f, 0x5090, 0x5890, 0x586f, 0x586f, 0x6999, 0x6977, 0x6956, 0x6136, 0x58f5, 0x58f6, 0x50f6, 0x58f4, 0x50d4, 0x50b3, 0x50d3, 0x48b2, 0x50b3, 0x4893, 0x4893, 0xf79e, 0x4071, 0x4072, 0x4071, 0x3871, 0x3871, 0xf7be, 0xef7d, 0x3050, 0x3050,},
        {0x302c, 0x302c, 0x302c, 0x302c, 0x304d, 0x384e, 0x382d, 0x384e, 0x384e, 0x406f, 0x486f, 0x486f, 0x5070, 0x506f, 0x586f, 0x506f, 0x71b8, 0x6977, 0x6156, 0x6136, 0x58f6, 0x50f6, 0x58f5, 0x58d3, 0x50d3, 0x50d2, 0x50b2, 0x50b3, 0x48b3, 0x48b3, 0xf7be, 0x4071, 0x4092, 0xc800, 0x4071, 0x3871, 0xffdf, 0xf79e, 0x3050, 0x3050,},
        {0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x384e, 0x384e, 0x384e, 0x406f, 0x404f, 0x404f, 0x404f, 0x586f, 0x586f, 0x79d8, 0x7197, 0x6977, 0x6136, 0x5936, 0x6115, 0x58f5, 0x58d3, 0x58d3, 0x50b2, 0x50b2, 0x50b3, 0x48b3, 0x4091, 0x4091, 0x4091, 0x4091, 0x4071, 0x4071, 0x3850, 0x3050, 0x3050, 0x3050, 0x3050,},
        {0x282c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x382d, 0x384e, 0x386e, 0x404e, 0x404f, 0x404e, 0x406e, 0x586f, 0x5890, 0x79b7, 0x7197, 0x6957, 0x6137, 0x6115, 0x6115, 0x58f3, 0x58d3, 0x58d2, 0x50d2, 0x50d3, 0x48b2, 0x4090, 0xffff, 0x6212, 0x386f, 0xffff, 0xf79e, 0x3850, 0x304f, 0x304f, 0x304f, 0xffff,},
        {0x302c, 0x302c, 0x302c, 0x302c, 0x304c, 0x302c, 0x302c, 0x302c, 0x384d, 0x384e, 0x384e, 0x384e, 0x384e, 0x404e, 0x404e, 0x484e, 0x588f, 0x79f8, 0x7197, 0x6977, 0x6957, 0x6935, 0x6115, 0x60f3, 0x58f3, 0x58d3, 0x58d3, 0x50d3, 0x50d3, 0x4891, 0x4091, 0x4892, 0x4092, 0xffff, 0x3871, 0x3851, 0xc5fb, 0x3850, 0x3050, 0x3050,},
        {0x282c, 0x302c, 0x302c, 0x302c, 0x282c, 0x302c, 0x304c, 0x302c, 0x302c, 0x384d, 0x384e, 0x384e, 0x384e, 0x384e, 0x384e, 0x382d, 0x506f, 0x79f8, 0x71b7, 0x7197, 0x6956, 0x6955, 0x6135, 0x60f3, 0x60f3, 0x58d3, 0x50b2, 0x50b2, 0x50d3, 0x4891, 0xf79e, 0x4892, 0x4071, 0xf443, 0x3871, 0x3871, 0xf7be, 0xef7d, 0x3070, 0x3070,},
        {0x282c, 0x302c, 0x302c, 0x302c, 0x282c, 0x302c, 0x302c, 0x302c, 0x302c, 0x384d, 0x382d, 0x384e, 0x382d, 0x384e, 0x382d, 0x384e, 0x384e, 0x5870, 0x79d7, 0x79b7, 0x6956, 0x7175, 0x6135, 0x6113, 0x60f3, 0x58f3, 0x58d3, 0x50d3, 0x50b1, 0x4891, 0xf7be, 0x4892, 0x4072, 0xfdaf, 0x4071, 0x4071, 0xffdf, 0xf79e, 0x3050, 0x3050,},
        {0x202a, 0x282c, 0x302c, 0x302c, 0x304c, 0x302c, 0x302c, 0x302c, 0x302c, 0x302c, 0x384d, 0x384d, 0x382d, 0x382d, 0x382d, 0x382d, 0x382e, 0x5870, 0x8217, 0x79d6, 0x7195, 0x7175, 0x6954, 0x6914, 0x6113, 0x60d3, 0x58d2, 0x50b2, 0x5091, 0x5091, 0x4891, 0x4872, 0x4071, 0x4071, 0x4071, 0x3871, 0x3870, 0x3870, 0x3050, 0x3050,},
        {0x202a, 0x202b, 0x282b, 0x302c, 0x282c, 0x282c, 0x282c, 0x302c, 0x302c, 0x302c, 0x302d, 0x304d, 0x302d, 0x382d, 0x382d, 0x382d, 0x382e, 0x5870, 0x8a57, 0x81f6, 0x79b5, 0x7995, 0x7174, 0x6954, 0x6113, 0x6113, 0x58d2, 0x58d1, 0x50b1, 0x48b1, 0x4090, 0x4090, 0x4071, 0x4071, 0x4071, 0xffff, 0x384f, 0xffff, 0xffff, 0x304e,},
        {0x202a, 0x202b, 0x202a, 0x202a, 0x202b, 0x202b, 0x282c, 0x302c, 0x302c, 0x302c, 0x304c, 0x302c, 0x302c, 0x302d, 0x382d, 0x382d, 0x382d, 0x382e, 0x5870, 0x8a36, 0x81f6, 0x79d5, 0x7194, 0x6954, 0x6933, 0x60f2, 0x60f2, 0x58d1, 0x58d1, 0x50b1, 0x4891, 0x4891, 0x4871, 0x4091, 0x4071, 0x4070, 0x3870, 0x3850, 0x3870, 0x3050,},
        {0x202b, 0x202a, 0x202a, 0x202a, 0x202b, 0x202a, 0x202a, 0x202a, 0x202a, 0x302c, 0x304c, 0x302c, 0x302c, 0x302d, 0x382d, 0x382d, 0x382d, 0x382e, 0x5070, 0x8a56, 0x8216, 0x79d5, 0x7994, 0x7174, 0x6932, 0x6112, 0x60f1, 0x58d1, 0x58d1, 0x767f, 0x769f, 0x4892, 0x4891, 0xdf5f, 0x4071, 0x4071, 0xf7be, 0xef5d, 0x3870, 0x304f,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x302c, 0x302c, 0x302c, 0x304c, 0x382d, 0x384d, 0x384e, 0x5070, 0x9296, 0x8a55, 0x81f5, 0x7993, 0x7173, 0x6952, 0x6912, 0x60f1, 0x60f1, 0x58d2, 0x767f, 0x769f, 0x4891, 0x4891, 0xf7be, 0x4891, 0x4070, 0xffdf, 0xf79e, 0x386f, 0x304f,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x304c, 0x302c, 0x302c, 0x382d, 0x382d, 0x404f, 0x5070, 0x8a75, 0x81f4, 0x81d3, 0x7973, 0x7152, 0x6931, 0x6911, 0x60f2, 0x58d1, 0x50b1, 0x50b1, 0x5091, 0x4891, 0x4891, 0x4071, 0x4070, 0x4070, 0x3870, 0x386f, 0x304f,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x280b, 0x302c, 0x302c, 0x384d, 0x382d, 0x404e, 0x5070, 0x9275, 0x9234, 0x89f3, 0x7993, 0x7972, 0x7131, 0x6932, 0x6112, 0x60d2, 0x58d2, 0x50b1, 0x50b2, 0x4890, 0x4070, 0x406f, 0x4070, 0x386f, 0x386e, 0x384e, 0x306e,},
        {0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x202a, 0x2029, 0x304c, 0x302c, 0x382c, 0x382d, 0x404e, 0x5070, 0x9294, 0x9233, 0x8a13, 0x81b3, 0x7972, 0x7152, 0x6931, 0x6111, 0x58d1, 0x58d1, 0x50b1, 0x5091, 0x4891, 0x4871, 0x4870, 0x4070, 0x4070, 0x386f, 0x386f, 0x304f,},
        {0x1808, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x2029, 0x302c, 0x382d, 0x382d, 0x402e, 0x484f, 0x58b0, 0x9a53, 0x9213, 0x81b2, 0x8192, 0x7152, 0x6931, 0x60f1, 0x60f1, 0x58d1, 0xc618, 0x50b1, 0x5091, 0x4229, 0x4890, 0x4890, 0xf7be, 0xce79, 0x384f, 0x384f,},
        {0x1808, 0x1828, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x2029, 0x1829, 0x302c, 0x302c, 0x382d, 0x382d, 0x484f, 0x5070, 0x9a12, 0x91f2, 0x89d2, 0x89b3, 0x7951, 0x7132, 0x6912, 0x60f1, 0x60d1, 0xf79e, 0x50b1, 0x5091, 0x0,    0x4890, 0x4870, 0xffdf, 0xf79e, 0x384f, 0x384f,},
        {0x1828, 0x1827, 0x1827, 0x1807, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x1829, 0x1829, 0x302c, 0x382d, 0x382d, 0x484e, 0x5050, 0x99d1, 0x99d2, 0x9192, 0x8972, 0x8152, 0x7932, 0x7111, 0x68d1, 0x60d1, 0x60b1, 0x5891, 0x58b1, 0x5091, 0x5070, 0x4890, 0x406f, 0x406f, 0x386f, 0x384f,},
        {0x1828, 0x1808, 0x1807, 0x1827, 0x1027, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x202a, 0x1829, 0x1829, 0x1829, 0x302c, 0x302d, 0x384d, 0x484e, 0x484f, 0x5070, 0x9991, 0x9171, 0x9171, 0x8931, 0x8132, 0x7912, 0x70f2, 0x60b0, 0x60b0, 0x60b1, 0x508f, 0x506f, 0x486f, 0x4890, 0x406d, 0x384d, 0x384e, 0x384e,},
        {0x1808, 0x1808, 0x1807, 0x1007, 0x1007, 0x1007, 0x202a, 0x202a, 0x202a, 0x202a, 0x2029, 0x2029, 0x2029, 0x1829, 0x1829, 0x1829, 0x1829, 0x302c, 0x382d, 0x402e, 0x482f, 0x5830, 0x9171, 0x9972, 0x9952, 0x9132, 0x9112, 0x8912, 0x78f2, 0x70b1, 0x68b2, 0x6892, 0x6091, 0x5871, 0x5070, 0x5070, 0x486f, 0x406f, 0x406e, 0x384e,},
        {0x1808, 0x1807, 0x1807, 0x1007, 0x1007, 0x1007, 0x1007, 0x202a, 0x202a, 0x2029, 0x202a, 0x202a, 0x1829, 0x1829, 0x2029, 0x1829, 0x1829, 0x302c, 0x382d, 0x402e, 0x484e, 0x5850, 0x6051, 0x9113, 0x90f3, 0x90f3, 0x88d2, 0x80b2, 0x80b2, 0x6e7f, 0x767f, 0x6871, 0x6891, 0xf79e, 0x5870, 0x5070, 0x769f, 0x767f, 0x406e, 0x382e,},
        {0x1828, 0x1828, 0x1807, 0x1007, 0x1007, 0x1007, 0x1006, 0x1026, 0x2029, 0x1829, 0x1829, 0x1829, 0x2029, 0x2029, 0x1829, 0x1829, 0x1829, 0x1829, 0x382c, 0x404d, 0x482e, 0x504f, 0x5830, 0x7853, 0x9914, 0x90d3, 0x88d3, 0x88b3, 0x80d2, 0x767f, 0x769f, 0x6871, 0x6871, 0x8c70, 0x5870, 0x5070, 0x769f, 0x769f, 0x406e, 0x384e,},
        {0x1828, 0x1807, 0x1827, 0x1007, 0x1007, 0x1007, 0x1026, 0x1026, 0x1026, 0x1829, 0x2029, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1809, 0x402d, 0x484e, 0x504f, 0x5830, 0x6031, 0x8093, 0x8874, 0x90d3, 0x88b3, 0x8092, 0x80b2, 0x7872, 0x7072, 0x6871, 0x6050, 0x5850, 0x5870, 0x504f, 0x486f, 0x406e, 0x304d,},
        {0x1807, 0x1807, 0x1807, 0x1007, 0x1007, 0x1007, 0x1026, 0x1026, 0x1006, 0x1006, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x382d, 0x402e, 0x504f, 0x5830, 0x6031, 0x8074, 0x8054, 0x8054, 0x7833, 0x7833, 0x504d, 0x584f, 0x7071, 0x504d, 0x486c, 0x486c, 0x5870, 0x406d, 0x386a, 0x404e, 0x304d,},
        {0x1807, 0x1807, 0x1007, 0x1007, 0x1007, 0x1007, 0x1007, 0x1026, 0x1006, 0x1006, 0x1026, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x402e, 0x504f, 0x5850, 0x6031, 0x6832, 0x7833, 0x7833, 0x7833, 0x7833, 0x7053, 0x7032, 0x7032, 0x6030, 0x6050, 0x584f, 0x5850, 0x506f, 0x484e, 0x382d, 0x304c,},
        {0x1807, 0x1007, 0x1007, 0x1007, 0x1007, 0x1007, 0x1026, 0x1026, 0x1006, 0x1026, 0x1006, 0x1026, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x482f, 0x5830, 0x6051, 0x6831, 0x7033, 0x7853, 0x7853, 0x7032, 0x7032, 0x7052, 0x6832, 0x6851, 0x6031, 0x5850, 0x5850, 0x506f, 0x486e, 0x382d, 0x304c,},
        {0x1807, 0x1807, 0x1007, 0x1007, 0x1007, 0x1006, 0x1026, 0x1026, 0x1026, 0x1006, 0x1026, 0x1006, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x1829, 0x502f, 0x6031, 0x6831, 0x6832, 0x7032, 0x7032, 0x7052, 0x7012, 0x6831, 0x6831, 0x6851, 0x6050, 0x5850, 0x5870, 0x486f, 0x406e, 0x384d, 0x282c,},
};

void Lcd_ShowImageEncoding565(uint **image, uchar top, uchar left, uchar height,
                              uchar width) {
    Lcd_SetRegion(left, top, left + width - 1, top + height - 1);
    for (int i = 0; i < height; i++) {
        for (int j = 0; j < width; j++) {
            uint color = *((uint *) image + i * width + j);
            Lcd_WriteData_16Bit(color);
        }
    }
}

void show_all_chars(int offset, TextStyle *text_style) {
    uchar left_border = 0;
    uchar top_border = 0;
    for (int i = 0; i < 10; i++) {
        for (int j = 0; j < 14; j++) {
            Lcd_ShowLcd1602Char(left_border + j * 6, top_border + i * 8, (i * 14 + j + offset) % 128, text_style);
        }
    }
}

void main(void) {
    Mcu_InitIo();
    Lcd_Initial();
    bl = 1;
    Lcd_SingleColour((int) RED);
    Mcu_DelayMs(1000);
    Lcd_ShowImageEncoding565(screen_shot, 0, 0, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, 0, IMAGE_WIDTH * 2, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT, IMAGE_WIDTH, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT * 2, 0, IMAGE_HEIGHT, IMAGE_WIDTH);
    Lcd_ShowImageEncoding565(screen_shot, IMAGE_HEIGHT * 2, IMAGE_WIDTH * 2, IMAGE_HEIGHT, IMAGE_WIDTH);
    int offset = 0;
    TextStyle text_style = {LCD1602, GREEN, BLACK, 1};
//    while (1) {
//        Lcd_ShowImageEncoding565(screen_shot, 0, 0, 30, 30);
//        Mcu_DelayMs(300);
//    }
    while (1) {
        //show_all_chars(offset++);
        Lcd_ShowMessage1602("Temperature: -87'F.", 18, 0, 0, &text_style);
        Lcd_ShowMessage1602("Alice: ~Emm~", 12, 0, LCD1602HEIGHT + 1, &text_style);
        Lcd_ShowMessage1602("Bob: Yep!", 9, 0, LCD1602HEIGHT * 2 + 2, &text_style);
        Mcu_DelayMs(5000);
    }
}

